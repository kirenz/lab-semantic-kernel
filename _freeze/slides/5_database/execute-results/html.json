{
  "hash": "25e88b5fd4f95cc49c4284350859dfef",
  "result": {
    "markdown": "---\ntitle: Use a Database\ntitle-slide-attributes:\n  data-background-image: ../images/logo.png\n  data-background-size: contain\n  data-background-opacity: \"0.5\"\nlang: en\nsubtitle: with Semantic Kernel\nauthor: Jan Kirenz\nexecute:\n  eval: false\n  echo: true\nhighlight-style: github\nformat:\n  revealjs: \n    toc: true\n    toc-depth: 1\n    embed-resources: false\n    theme: [dark, ../custom.scss]  \n    incremental: true\n    transition: slide\n    background-transition: fade\n    transition-speed: slow\n    code-copy: true\n    code-line-numbers: true\n    smaller: false\n    scrollable: true\n    slide-number: c\n    preview-links: auto\n    chalkboard: \n      buttons: false\n   # logo: ../images/logo.png\n    footer: Jan Kirenz\n---\n\n# Use a Database\n\n# Setup\n\n## Python\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport shutil\nfrom IPython.display import display, Markdown\nimport semantic_kernel as sk\nfrom semantic_kernel.connectors.ai.open_ai import OpenAIChatCompletion, OpenAITextEmbedding\nfrom semantic_kernel.connectors.memory.chroma import ChromaMemoryStore\n```\n:::\n\n\n## Kernel and completion service\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nkernel = sk.Kernel()\n\napi_key, org_id = sk.openai_settings_from_dot_env()\n\n# Completion service\nkernel.add_text_completion_service(\n    \"openai-completion\", OpenAIChatCompletion(\"gpt-3.5-turbo\", api_key, org_id))\n```\n:::\n\n\n## Embeddings and database\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Embedding service\nkernel.add_text_embedding_generation_service(\n    \"openai-embedding\", OpenAITextEmbedding(\"text-embedding-ada-002\", api_key, org_id))\n```\n:::\n\n\n[Chroma](https://docs.trychroma.com/) database:\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nkernel.register_memory_store(\n    memory_store=ChromaMemoryStore(persist_directory='../data/mymemories'))\n\nprint(\"\")\n```\n:::\n\n\n## Reset database (if necessary)\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# ONLY DELETE THE DIRECTORY IF YOU WANT TO CLEAR THE MEMORY\n# OTHERWISE, SET delete_dir = True\n\ndelete_dir = False\n\nif (delete_dir):\n    dir_path = \"../data/mymemories\"\n    shutil.rmtree(dir_path)\n    kernel.register_memory_store(\n        memory_store=ChromaMemoryStore(persist_directory=dir_path))\n    print(\"⚠️ Memory cleared and reset\")\n```\n:::\n\n\n# Import Data into Database\n\n## Input data {.smaller}\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nstrength_questions = [\"What unique recipes or ingredients does the pizza shop use?\", \"What are the skills and experience of the staff?\", \"Does the pizza shop have a strong reputation in the local area?\",\n                      \"Are there any unique features of the shop or its location that attract customers?\", \"Does the pizza shop have a strong reputation in the local area?\", \"Are there any unique features of the shop or its location that attract customers?\"]\nweakness_questions = [\"What are the operational challenges of the pizza shop? (e.g., slow service, high staff turnover)\", \"Are there financial constraints that limit growth or improvements?\",\n                      \"Are there any gaps in the product offering?\", \"Are there customer complaints or negative reviews that need to be addressed?\"]\nopportunities_questions = [\"Is there potential for new products or services (e.g., catering, delivery)?\", \"Are there under-served customer segments or market areas?\",\n                           \"Can new technologies or systems enhance the business operations?\", \"Are there partnerships or local events that can be leveraged for marketing?\"]\nthreats_questions = [\"Who are the major competitors and what are they offering?\", \"Are there potential negative impacts due to changes in the local area (e.g., construction, closure of nearby businesses)?\",\n                     \"Are there economic or industry trends that could impact the business negatively (e.g., increased ingredient costs)?\", \"Is there any risk due to changes in regulations or legislation (e.g., health and safety, employment)?\"]\n\nstrengths = [\"Unique garlic pizza recipe that wins top awards\", \"Owner trained in Sicily at some of the best pizzerias\",\n             \"Strong local reputation\", \"Prime location on university campus\"]\nweaknesses = [\"High staff turnover\", \"Floods in the area damaged the seating areas that are in need of repair\",\n              \"Absence of popular calzones from menu\", \"Negative reviews from younger demographic for lack of hip ingredients\"]\nopportunities = [\"Untapped catering potential\", \"Growing local tech startup community\",\n                 \"Unexplored online presence and order capabilities\", \"Upcoming annual food fair\"]\nthreats = [\"Competition from cheaper pizza businesses nearby\", \"There's nearby street construction that will impact foot traffic\",\n           \"Rising cost of cheese will increase the cost of pizzas\", \"No immediate local regulatory changes but it's election season\"]\n```\n:::\n\n\n## Import into database {.smaller}\n\n- Create embeddings and store data\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nmemoryCollectionName = \"SWOT\"\n\nfor i in range(len(strengths)):\n    await kernel.memory.save_information_async(memoryCollectionName, id=f\"strength-{i}\", text=f\"Internal business strength (S in SWOT) that makes customers happy and satisfied Q&A: Q: {strength_questions[i]} A: {strengths[i]}\")\n\nfor i in range(len(weaknesses)):\n    await kernel.memory.save_information_async(memoryCollectionName, id=f\"weakness-{i}\", text=f\"Internal business weakness (W in SWOT) that makes customers unhappy and dissatisfied Q&A: Q: {weakness_questions[i]} A: {weaknesses[i]}\")\n\nfor i in range(len(opportunities)):\n    await kernel.memory.save_information_async(memoryCollectionName, id=f\"opportunity-{i}\", text=f\"External opportunity (O in SWOT) for the business to gain entirely new customers Q&A: Q: {opportunities_questions[i]} A: {opportunities[i]}\")\n\nfor i in range(len(threats)):\n    await kernel.memory.save_information_async(memoryCollectionName, id=f\"threat-{i}\", text=f\"External threat (T in SWOT) to the business that impacts its survival Q&A: Q: {threats_questions[i]} A: {threats[i]}\")\n```\n:::\n\n\n# Use case: How to make more money?\n\n## Question\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\npotential_question = \"What are the easiest ways to make more money?\"\n```\n:::\n\n\n## Memory search\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ncounter = 0\n\nmemories = await kernel.memory.search_async(memoryCollectionName, potential_question, limit=5, min_relevance_score=0.5)\n```\n:::\n\n\n## Result\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\ndisplay(Markdown(f\"### ❓ Potential question: {potential_question}\"))\n```\n:::\n\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nfor memory in memories:\n    if counter == 0:\n        related_memory = memory.text\n    counter += 1\n    print(\n        f\"  > Similarity result {counter}:\\n  >> ID: {memory.id}\\n  Text: {memory.text}  Relevance: {memory.relevance}\\n\")\n```\n:::\n\n\n## Result\n\n```markdown\n> Similarity result 1:\n  >> ID: opportunity-0\n  Text: External opportunity (O in SWOT) for the business to gain entirely new customers Q&A: Q: Is there potential for new products or services (e.g., catering, delivery)? A: Untapped catering potential  Relevance: 0.7721327504132071\n\n  > Similarity result 2:\n  >> ID: opportunity-3\n  Text: External opportunity (O in SWOT) for the business to gain entirely new customers Q&A: Q: Are there partnerships or local events that can be leveraged for marketing? A: Upcoming annual food fair  Relevance: 0.770177891378116\n\n  > Similarity result 3:\n  >> ID: opportunity-1\n  Text: External opportunity (O in SWOT) for the business to gain entirely new customers Q&A: Q: Are there under-served customer segments or market areas? A: Growing local tech startup community  Relevance: 0.7698220128086722\n\n  > Similarity result 4:\n  >> ID: opportunity-2\n  Text: External opportunity (O in SWOT) for the business to gain entirely new customers Q&A: Q: Can new technologies or systems enhance the business operations? A: Unexplored online presence and order capabilities  Relevance: 0.7676498736381523\n\n  > Similarity result 5:\n  >> ID: threat-0\n  Text: External threat (T in SWOT) to the business that impacts its survival Q&A: Q: Who are the major competitors and what are they offering? A: Competition from cheaper pizza businesses nearby  Relevance: 0.7522373129207561\n```\n\n# Use Case: How to Save Time?\n\n## Question\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\nwhat_if_scenario = \"How can the business owner save time?\"\n```\n:::\n\n\n## Memory search\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\ncounter = 0\ngathered_context = []\nmax_memories = 3\n```\n:::\n\n\n. . .\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\nmemories = await kernel.memory.search_async(memoryCollectionName, what_if_scenario, limit=max_memories, min_relevance_score=0.77)\n```\n:::\n\n\n## Save output to database\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nprint(f\"✨ Leveraging information available to address '{what_if_scenario}'...\")\n\nfor memory in memories:\n    if counter == 0:\n        related_memory = memory.text\n    counter += 1\n    gathered_context.append(memory.text + \"\\n\")\n    print(f\"  > Hit {counter}: {memory.id} \")\n```\n:::\n\n\n## Create presentation\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\nskillsDirectory = \"../plugins-sk\"\n\npluginFC = kernel.import_semantic_skill_from_directory(\n    skillsDirectory, \"FriendlyConsultant\")\n```\n:::\n\n\n## Context\n\n::: {.cell execution_count=17}\n``` {.python .cell-code}\nmy_context = kernel.create_new_context()\nmy_context['input'] = what_if_scenario\nmy_context['context'] = \"\\n\".join(gathered_context)\n```\n:::\n\n\n## Presentation output\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\npreso_result = await kernel.run_async(pluginFC[\"Presentation\"], input_context=my_context)\n```\n:::\n\n\n::: {.cell execution_count=19}\n``` {.python .cell-code}\ndisplay(Markdown(\"# ✨ Generated presentation ...\\n\"+str(preso_result)))\n```\n:::\n\n\n## Output\n\n```markdown\n\n✨ Generated presentation ...\n\n# Business Strategy Consultant Presentation\n\n# Summary\n\nThe business owner has asked for ways to save time. We will explore three key concerns that can help the business owner save time and improve operations.\n\n# The Question\n- How can the business owner save time?\n\n# Key Concerns\n\n1. Unexplored online presence and order capabilities\n2. Untapped catering potential\n3. Growing local tech startup community\n\n# Unexplored Online Presence and Order Capabilities\n\n- Explanation: The business can save time by implementing online ordering capabilities and improving their online presence. This will allow customers to place orders without the need for phone calls or in-person visits.\n\n- Example: The business can create a website with an online ordering system and integrate it with their social media accounts. This will allow customers to easily place orders and the business can save time by not having to take orders over the phone.\n\n# Untapped Catering Potential\n\n- Explanation: The business can save time by exploring catering opportunities. This will allow the business to serve multiple customers at once and potentially increase revenue.\n\n- Example: The business can create a catering menu and market it to local businesses and events. This will allow the business to serve multiple customers at once and save time by not having to prepare individual orders.\n\n# Growing Local Tech Startup Community\n\n- Explanation: The business can save time by targeting under-served customer segments or market areas. The growing local tech startup community is an opportunity for the business to gain new customers and potentially increase revenue.\n\n- Example: The business can create a marketing campaign targeted towards the local tech startup community. This will allow the business to gain new customers and potentially increase revenue.\n\n# Summary\n\n- By implementing online ordering capabilities, exploring catering opportunities, and targeting under-served customer segments, the business owner can save time and improve operations.\n\n```\n\n\n# Acknowledgments\n\n*This tutorial is mainly based on the excellent course [\"How Business Thinkers Can Start Building AI Plugins With Semantic Kernel\"](https://www.deeplearning.ai/short-courses/microsoft-semantic-kernel/) provided by John Maeda and Andrew Ng*\n\n# What's next? {background-image=\"../images/logo.png\" background-opacity=\"0.5\"}\n\n- **Congratulations! You have completed this tutorial** 👍\n\n**Next, you may want to go back to the [lab's website](https://kirenz.github.io/semantic-kernel/)**\n\n",
    "supporting": [
      "5_database_files"
    ],
    "filters": [],
    "includes": {}
  }
}